<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lobby System</title>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <h1>Lobby System</h1>

    <h2>Opret en Lobby</h2>
    <input id="createName" placeholder="Indtast dit navn">
    <button onclick="createLobby()">Opret Lobby</button>
    <p id="lobbyIDDisplay"></p>

    <h2>Tilslut en Lobby</h2>
    <input id="joinName" placeholder="Indtast dit navn">
    <input id="joinLobbyID" placeholder="Indtast lobby ID">
    <button onclick="joinLobby()">Tilslut Lobby</button>
    <p id="errorMessage" style="color: red;"></p>

    <h3>Brugere i lobbyen:</h3>
    <ul id="userList"></ul>

    <h3>Chat</h3>
    <div id="chatWindow" style="border: 1px solid #000; width: 100%; height: 200px; overflow-y: scroll;">
        <ul id="messages"></ul>
    </div>
    <input id="messageInput" placeholder="Skriv din besked her">
    <button onclick="sendMessage()">Send Besked</button>

    <script>
        const socket = io();

        function createLobby() {
            const userName = document.getElementById('createName').value;
            socket.emit('create_lobby', userName);
            document.getElementById('createName').value = ''; 
        }

        function joinLobby() {
            const userName = document.getElementById('joinName').value;
            const lobbyID = document.getElementById('joinLobbyID').value;
            socket.emit('join_lobby', lobbyID, userName);
            document.getElementById('joinName').value = ''; 
            document.getElementById('joinLobbyID').value = '';
        }

        socket.on('lobby_created', (lobbyID) => {
            document.getElementById('lobbyIDDisplay').innerText = `Lobby ID: ${lobbyID}`;
        });

        socket.on('user_joined', (userList) => {
            const userListElement = document.getElementById('userList');
            userListElement.innerHTML = '';
            userList.forEach(user => {
                const li = document.createElement('li');
                li.textContent = user;
                userListElement.appendChild(li);
            });
        });

        function sendMessage() {
            const messageContent = document.getElementById('messageInput').value;
            socket.emit('send_message', messageContent);
            document.getElementById('messageInput').value = '';
        }

        socket.on('new_message', (message) => {
            const messageList = document.getElementById('messages');
            const li = document.createElement('li');
            li.textContent = `${message.username}: ${message.content}`;
            messageList.appendChild(li);
        });

        socket.on('error', (message) => {
            document.getElementById('errorMessage').innerText = message;
        });
    </script>
</body>
</html>
